'use strict';

const h3 = require('h3');
const listhen = require('listhen');
const core = require('@unlighthouse/core');

async function createServer() {
  const { resolvedConfig } = core.useUnlighthouse();
  const app = h3.createApp();
  const server = await listhen.listen(h3.toNodeListener(app), {
    ...resolvedConfig.server,
    // delay opening the server until the app is ready
    open: false
  });
  return { app, server };
}

exports.createServer = createServer;
