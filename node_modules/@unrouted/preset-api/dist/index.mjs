import { defineUnroutedPreset } from '@unrouted/core';
import cors from 'cors';
import { fromNodeMiddleware } from 'h3';

const name = "@unrouted/preset-api";
const version = "0.5.0";

const presetApi = defineUnroutedPreset({
  meta: {
    name,
    version
  },
  defaults: {
    cors: true
  },
  setup(ctx, options) {
    if (options.cors) {
      const corsOptions = typeof options.cors === "boolean" ? {} : options.cors;
      ctx.config.middleware.push(fromNodeMiddleware(cors(corsOptions)));
    }
  }
});

export { presetApi };
