'use strict';

const core = require('@unrouted/core');
const cors = require('cors');
const h3 = require('h3');

const name = "@unrouted/preset-api";
const version = "0.5.0";

const presetApi = core.defineUnroutedPreset({
  meta: {
    name,
    version
  },
  defaults: {
    cors: true
  },
  setup(ctx, options) {
    if (options.cors) {
      const corsOptions = typeof options.cors === "boolean" ? {} : options.cors;
      ctx.config.middleware.push(h3.fromNodeMiddleware(cors(corsOptions)));
    }
  }
});

exports.presetApi = presetApi;
